<!doctype html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#9c27b0">
  <title>Ù…Ø¯ÛŒØ±ÛŒØª ØªØºØ°ÛŒÙ‡ Ø¨ÛŒÙ…Ø§Ø±Ø§Ù† Ø¯ÛŒØ§Ù„ÛŒØ²ÛŒ</title>
  <link rel="manifest" href="/manifest.json">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Vazirmatn:wght@100;200;300;400;500;600;700;800;900&display=swap');
    
    :root {
      --primary-color: #9c27b0;
      --secondary-color: #7b1fa2;
      --text-color: #333;
      --background-color: #f8f8f8;
      --accent-color: #e1bee7;
      --font-size: 1rem;
    }
    
    * {
      font-family: 'Vazirmatn', sans-serif;
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      direction: rtl;
      background-color: var(--background-color);
      color: var(--text-color);
      font-size: var(--font-size);
      line-height: 1.6;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }
    
    .container {
      max-width: 600px;
      margin: 20px auto;
      padding: 1rem;
      background-color: white;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      flex: 1;
    }
    
    .header {
      background-color: var(--primary-color);
      color: white;
      padding: 1rem;
      border-radius: 10px 10px 0 0;
      text-align: center;
      margin-bottom: 10px;
    }
    
    .nav {
      display: flex;
      justify-content: space-around;
      margin-bottom: 1rem;
      flex-wrap: wrap;
    }
    
    .nav button {
      border: none;
      border-radius: 5px;
      background-color: var(--secondary-color);
      color: white;
      cursor: pointer;
      padding: 0.5rem 1rem;
      font-size: 1rem;
      flex: 1;
      margin: 0.2rem;
      transition: all 0.3s ease;
    }
    
    .nav button:hover {
      background-color: var(--primary-color);
    }
    
    .nav button.active {
      background-color: var(--primary-color);
    }
    
    .section {
      display: none;
      background-color: white;
      padding: 1rem;
      border-radius: 0 0 10px 10px;
    }
    
    .section.active {
      display: block;
    }
    
    .food-form,
    .new-food-form,
    .settings-form,
    .edit-food-form {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-bottom: 20px;
    }
    
    input,
    select,
    button {
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 5px;
      font-size: 1rem;
      box-sizing: border-box;
    }
    
    .warning {
      color: white;
      font-weight: bold;
      margin: 10px 0;
      padding: 10px;
      border-radius: 5px;
      background-color: #f44336;
      text-align: center;
    }
    
    .chart-container {
      margin-top: 10px;
      height: 150px;
      border-radius: 10px;
      border: 1px solid #ddd;
      display: flex;
      justify-content: flex-start;
      align-items: center;
      position: relative;
      flex-direction: row;
      width: 48%;
    }
    
    .chart-container canvas {
      max-width: 60%;
      max-height: 100%;
    }
    
    .limit-line {
      position: absolute;
      left: 0;
      right: 0;
      border-bottom: 2px dashed;
    }
    
    .limit-line.safe {
      border-color: green;
    }
    
    .limit-line.danger {
      border-color: red;
    }
    
    .chart-info {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      margin-right: 10px;
      flex: 1;
    }
    
    .chart-face-sticker {
      font-size: 2rem;
      text-align: center;
      margin-bottom: 5px;
    }
    
    .chart-label {
      font-size: 0.8rem;
      text-align: right;
    }
    
    .chart-percentage {
      font-size: 0.9rem;
      text-align: right;
      margin-bottom: 5px;
    }
    
    .chart-value {
      font-size: 0.9rem;
      text-align: right;
    }
    
    .food-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
      border: 1px solid #ddd;
      border-radius: 10px;
      overflow: hidden;
    }
    
    .food-table th,
    .food-table td {
      padding: 0.5rem;
      border-bottom: 1px solid #ddd;
      text-align: center;
    }
    
    .food-table th {
      background-color: #f0f0f0;
    }
    
    .current-totals {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin-bottom: 10px;
    }
    
    .current-totals p {
      background-color: #eee;
      padding: 0.5rem;
      border-radius: 5px;
      font-size: 0.9rem;
      text-align: center;
    }
    
    .reset-button {
      background-color: #f44336;
      color: white;
      border: none;
      padding: 10px;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.3s ease;
      margin-top: 20px;
      width: 100%;
    }
    
    .reset-button:hover {
      background-color: #d32f2f;
    }
    
    .theme-settings {
      margin-top: 20px;
      display: grid;
      grid-template-columns: 1fr;
      gap: 10px;
    }
    
    .theme-settings label {
      font-weight: bold;
    }
    
    .theme-settings input[type="color"],
    .theme-settings input[type="number"] {
      width: 100%;
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 5px;
      box-sizing: border-box;
    }
    
    .theme-settings button {
      grid-column: span 1;
      background-color: var(--secondary-color);
      color: white;
      border: none;
      padding: 10px;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    
    .theme-settings button:hover {
      background-color: var(--primary-color);
    }
    
    .face-sticker {
      font-size: 3rem;
      text-align: center;
      margin-bottom: 10px;
    }
    
    .edit-food-form {
      display: none;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-bottom: 20px;
    }
    
    .edit-food-form.active {
      display: grid;
    }
    
    .edit-food-form input,
    .edit-food-form button {
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 5px;
      font-size: 1rem;
      box-sizing: border-box;
    }
    
    .history-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
      border: 1px solid #ddd;
      border-radius: 10px;
      overflow: hidden;
    }
    
    .history-table th,
    .history-table td {
      padding: 0.5rem;
      border-bottom: 1px solid #ddd;
      text-align: center;
    }
    
    .history-table th {
      background-color: #f0f0f0;
    }
    
    .history-table button {
      padding: 5px 10px;
      font-size: 0.9rem;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      background-color: var(--secondary-color);
      color: white;
      transition: background-color 0.3s ease;
    }
    
    .history-table button:hover,
    .food-table button:hover {
      background-color: var(--primary-color);
    }
    
    /* Styles for videos */
    .video-container {
      margin: 20px 0;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      aspect-ratio: 16 / 9;
    }
    
    .video-container iframe {
      width: 100%;
      height: 100%;
      border: none;
    }
    
    /* Styles for articles */
    .education-list details {
      margin-bottom: 10px;
      border: 1px solid #ddd;
      border-radius: 5px;
      padding: 5px;
      background-color: #f9f9f9;
    }
    
    .education-list summary {
      font-weight: bold;
      cursor: pointer;
      padding: 5px;
    }
    
    .education-item {
      cursor: pointer;
      padding: 5px 10px;
      border-bottom: 1px solid #eee;
      transition: background-color 0.2s ease;
    }
    
    .education-item:hover {
      background-color: #f0f0f0;
    }
    
    @media (max-width: 768px) {
      .container {
        margin: 10px auto;
        padding: 0.5rem;
      }
      .nav {
        flex-direction: column;
      }
      .nav button {
        margin: 0.2rem 0;
      }
      .food-form,
      .new-food-form,
      .settings-form,
      .edit-food-form {
        grid-template-columns: 1fr;
      }
      .current-totals {
        grid-template-columns: 1fr;
      }
      .chart-container {
        width: 100%;
      }
      .education-list {
        grid-template-columns: 1fr;
      }
    }
  </style>
  <!-- Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Chart.js Ø§Ø² CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>Ù…Ø¯ÛŒØ±ÛŒØª ØªØºØ°ÛŒÙ‡ Ø¨ÛŒÙ…Ø§Ø±Ø§Ù† Ø¯ÛŒØ§Ù„ÛŒØ²ÛŒ</h1>
    </div>
    <div class="nav">
      <button onclick="showSection('dashboard')" class="active">Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯</button>
      <button onclick="showSection('videos')">ÙÛŒÙ„Ù…â€ŒÙ‡Ø§ÛŒ Ø¢Ù…ÙˆØ²Ø´ÛŒ</button>
      <button onclick="showSection('articles')">Ù…Ù‚Ø§Ù„Ø§Øª Ø¢Ù…ÙˆØ²Ø´ÛŒ</button>
      <button onclick="showSection('foodList')">Ù„ÛŒØ³Øª Ù…ÙˆØ§Ø¯ ØºØ°Ø§ÛŒÛŒ</button>
      <button onclick="showSection('addFood')">Ø§ÙØ²ÙˆØ¯Ù† ØºØ°Ø§</button>
      <button onclick="showSection('history')">ØªØ§Ø±ÛŒØ®Ú†Ù‡</button>
      <button onclick="showSection('settings')">ØªÙ†Ø¸ÛŒÙ…Ø§Øª</button>
    </div>

    <!-- Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ -->
    <div id="dashboard" class="section active">
      <div class="chart-container-grid">
        <div class="chart-container">
          <canvas id="sodiumChart"></canvas>
          <div class="chart-info">
            <div class="chart-face-sticker" id="sodiumFaceSticker"></div>
            <div class="chart-label">Ø³Ø¯ÛŒÙ…</div>
            <div class="chart-percentage" id="sodiumPercentage"></div>
            <div class="chart-value" id="sodiumValue"></div>
          </div>
        </div>
        <div class="chart-container">
          <canvas id="potassiumChart"></canvas>
          <div class="chart-info">
            <div class="chart-face-sticker" id="potassiumFaceSticker"></div>
            <div class="chart-label">Ù¾ØªØ§Ø³ÛŒÙ…</div>
            <div class="chart-percentage" id="potassiumPercentage"></div>
            <div class="chart-value" id="potassiumValue"></div>
          </div>
        </div>
        <div class="chart-container">
          <canvas id="phosphorusChart"></canvas>
          <div class="chart-info">
            <div class="chart-face-sticker" id="phosphorusFaceSticker"></div>
            <div class="chart-label">ÙØ³ÙØ±</div>
            <div class="chart-percentage" id="phosphorusPercentage"></div>
            <div class="chart-value" id="phosphorusValue"></div>
          </div>
        </div>
        <div class="chart-container">
          <canvas id="proteinChart"></canvas>
          <div class="chart-info">
            <div class="chart-face-sticker" id="proteinFaceSticker"></div>
            <div class="chart-label">Ù¾Ø±ÙˆØªØ¦ÛŒÙ†</div>
            <div class="chart-percentage" id="proteinPercentage"></div>
            <div class="chart-value" id="proteinValue"></div>
          </div>
        </div>
        <div class="chart-container">
          <canvas id="waterChart"></canvas>
          <div class="chart-info">
            <div class="chart-face-sticker" id="waterFaceSticker"></div>
            <div class="chart-label">Ø¢Ø¨</div>
            <div class="chart-percentage" id="waterPercentage"></div>
            <div class="chart-value" id="waterValue"></div>
          </div>
        </div>
      </div>
      <div class="current-totals" id="currentTotals"></div>
      <div id="warnings"></div>
      <h2>Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…ÙˆØ§Ø¯ Ù…ØºØ°ÛŒ</h2>
      <form class="food-form" onsubmit="addFoodEntry(event)">
        <select id="foodSelect" required></select>
        <input type="number" id="amount" placeholder="Ù…Ù‚Ø¯Ø§Ø± (ÙˆØ§Ø­Ø¯)" step="1" required>
        <select id="mealType" required>
          <option value="breakfast">ØµØ¨Ø­Ø§Ù†Ù‡</option>
          <option value="lunch">Ù†Ø§Ù‡Ø§Ø±</option>
          <option value="dinner">Ø´Ø§Ù…</option>
        </select>
        <select id="dayOfWeek" required>
          <option value="saturday">Ø´Ù†Ø¨Ù‡</option>
          <option value="sunday">ÛŒÚ©Ø´Ù†Ø¨Ù‡</option>
          <option value="monday">Ø¯ÙˆØ´Ù†Ø¨Ù‡</option>
          <option value="tuesday">Ø³Ù‡ Ø´Ù†Ø¨Ù‡</option>
          <option value="wednesday">Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡</option>
          <option value="thursday">Ù¾Ù†Ø¬ Ø´Ù†Ø¨Ù‡</option>
          <option value="friday">Ø¬Ù…Ø¹Ù‡</option>
        </select>
        <button type="submit">Ø«Ø¨Øª Ù…ØµØ±Ù</button>
      </form>
    </div>

    <!-- ÙÛŒÙ„Ù…â€ŒÙ‡Ø§ÛŒ Ø¢Ù…ÙˆØ²Ø´ÛŒ -->
    <div id="videos" class="section">
      <h2>ÙÛŒÙ„Ù…â€ŒÙ‡Ø§ÛŒ Ø¢Ù…ÙˆØ²Ø´ÛŒ</h2>
      <div class="video-container" id="videoContainer">
        <!-- Ù„ÛŒÙ†Ú©â€ŒÙ‡Ø§ÛŒ ÙˆÛŒØ¯ÛŒÙˆ Ø¯Ø± Ø§ÛŒÙ†Ø¬Ø§ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
      </div>
    </div>

    <!-- Ù…Ù‚Ø§Ù„Ø§Øª Ø¢Ù…ÙˆØ²Ø´ÛŒ -->
    <div id="articles" class="section">
      <h2>Ù…Ù‚Ø§Ù„Ø§Øª Ø¢Ù…ÙˆØ²Ø´ÛŒ</h2>
      <div class="education-list">
        <details>
          <summary>Ù…Ø­Ø¯ÙˆØ¯ÛŒØªâ€ŒÙ‡Ø§</summary>
          <div class="education-item" onclick="showArticleContent(0)">Û±. Ø§Ù‡Ù…ÛŒØª Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Ù…Ø§ÛŒØ¹Ø§Øª Ø¯Ø± Ø¯ÛŒØ§Ù„ÛŒØ²</div>
          <div class="education-item" onclick="showArticleContent(1)">Û². Ù…Ø¯ÛŒØ±ÛŒØª Ù…ØµØ±Ù Ù¾ØªØ§Ø³ÛŒÙ… Ø±ÙˆØ²Ø§Ù†Ù‡</div>
        </details>
        <details>
          <summary>ØªØºØ°ÛŒÙ‡ Ø¯ÛŒØ§Ù„ÛŒØ²ÛŒ</summary>
          <div class="education-item" onclick="showArticleContent(2)">Û³. Ù…Ù†Ø§Ø¨Ø¹ ØºØ°Ø§ÛŒÛŒ Ø­Ø§ÙˆÛŒ ÙØ³ÙØ± Ø¨Ø§Ù„Ø§</div>
          <div class="education-item" onclick="showArticleContent(3)">Û´. Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø±ÛŒØ²ÛŒ ÙˆØ¹Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ØºØ°Ø§ÛŒÛŒ Ù‡ÙØªÚ¯ÛŒ</div>
          <div class="education-item" onclick="showArticleContent(4)">Ûµ. Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ†â€ŒÙ‡Ø§ÛŒ Ù†Ù…Ú© Ø¯Ø± Ø±Ú˜ÛŒÙ… ØºØ°Ø§ÛŒÛŒ</div>
        </details>
        <details>
          <summary>ÙˆØ±Ø²Ø´ Ùˆ Ø³Ù„Ø§Ù…ØªÛŒ</summary>
          <div class="education-item" onclick="showArticleContent(5)">Û¶. Ú©Ù†ØªØ±Ù„ ÙØ´Ø§Ø± Ø®ÙˆÙ† Ø¯Ø± Ø¨ÛŒÙ…Ø§Ø±Ø§Ù† Ø¯ÛŒØ§Ù„ÛŒØ²ÛŒ</div>
          <div class="education-item" onclick="showArticleContent(6)">Û·. Ù†Ù‚Ø´ Ù¾Ø±ÙˆØªØ¦ÛŒÙ† Ø¯Ø± ØªØºØ°ÛŒÙ‡ Ø¯ÛŒØ§Ù„ÛŒØ²ÛŒ</div>
          <div class="education-item" onclick="showArticleContent(7)">Û¸. Ù…Ø¯ÛŒØ±ÛŒØª ÙˆØ²Ù† Ø¯Ø± Ø¨ÛŒÙ† Ø¬Ù„Ø³Ø§Øª Ø¯ÛŒØ§Ù„ÛŒØ²</div>
        </details>
        <details>
          <summary>Ù…ÙˆØ§Ø±Ø¯ Ø¯ÛŒÚ¯Ø±</summary>
          <div class="education-item" onclick="showArticleContent(8)">Û¹. ØºØ°Ø§Ù‡Ø§ÛŒ Ù…Ù…Ù†ÙˆØ¹Ù‡ Ø¨Ø±Ø§ÛŒ Ø¨ÛŒÙ…Ø§Ø±Ø§Ù† Ú©Ù„ÛŒÙˆÛŒ</div>
          <div class="education-item" onclick="showArticleContent(9)">Û±Û°. Ø±Ø§Ù‡Ú©Ø§Ø±Ù‡Ø§ÛŒ Ú©Ø§Ù‡Ø´ ØªØ´Ù†Ú¯ÛŒ</div>
          <div class="education-item" onclick="showArticleContent(10)">Û±Û±. Ù…ØµØ±Ù ØµØ­ÛŒØ­ Ù…Ú©Ù…Ù„â€ŒÙ‡Ø§ÛŒ ØºØ°Ø§ÛŒÛŒ</div>
          <div class="education-item" onclick="showArticleContent(11)">Û±Û². ÙˆØ±Ø²Ø´ Ùˆ ÙØ¹Ø§Ù„ÛŒØª Ø¨Ø¯Ù†ÛŒ Ù…Ù†Ø§Ø³Ø¨</div>
          <div class="education-item" onclick="showArticleContent(12)">Û±Û³. Ú©Ù†ØªØ±Ù„ Ù‚Ù†Ø¯ Ø®ÙˆÙ† Ø¯Ø± Ø¨ÛŒÙ…Ø§Ø±Ø§Ù† Ø¯ÛŒØ§Ø¨ØªÛŒ</div>
          <div class="education-item" onclick="showArticleContent(13)">Û±Û´. Ø±ÙˆØ´â€ŒÙ‡Ø§ÛŒ Ù¾Ø®Øª Ù…Ù†Ø§Ø³Ø¨</div>
          <div class="education-item" onclick="showArticleContent(14)">Û±Ûµ. Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ø³ØªØ±Ø³ Ùˆ Ø³Ù„Ø§Ù…Øª Ø±ÙˆØ§Ù†</div>
          <div class="education-item" onclick="showArticleContent(15)">Û±Û¶. Ù†Ø´Ø§Ù†Ù‡â€ŒÙ‡Ø§ÛŒ Ø§ÙˆØ±Ú˜Ø§Ù†Ø³ÛŒ Ø¯Ø± Ø¨ÛŒÙ…Ø§Ø±Ø§Ù†</div>
          <div class="education-item" onclick="showArticleContent(16)">Û±Û·. Ù…Ø±Ø§Ù‚Ø¨Øª Ø§Ø² Ø¯Ø³ØªØ±Ø³ÛŒ Ø¹Ø±ÙˆÙ‚ÛŒ</div>
          <div class="education-item" onclick="showArticleContent(17)">Û±Û¸. ØªØ¯Ø§Ø®Ù„Ø§Øª Ø¯Ø§Ø±ÙˆÛŒÛŒ Ø¨Ø§ Ù…ÙˆØ§Ø¯ ØºØ°Ø§ÛŒÛŒ</div>
          <div class="education-item" onclick="showArticleContent(18)">Û±Û¹. Ø¨Ø±Ù†Ø§Ù…Ù‡ ØºØ°Ø§ÛŒÛŒ Ù†Ù…ÙˆÙ†Ù‡ Ø±ÙˆØ²Ø§Ù†Ù‡</div>
          <div class="education-item" onclick="showArticleContent(19)">Û²Û°. Ù†Ú©Ø§Øª Ù…Ù‡Ù… Ø¨Ø±Ø§ÛŒ Ù‡Ù…Ø±Ø§Ù‡Ø§Ù† Ø¨ÛŒÙ…Ø§Ø±</div>
        </details>
      </div>
      <div id="articleContent">
        <!-- Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ù‚Ø§Ù„Ù‡ Ø¯Ø± Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ -->
      </div>
    </div>

    <!-- Ù„ÛŒØ³Øª Ù…ÙˆØ§Ø¯ ØºØ°Ø§ÛŒÛŒ -->
    <div id="foodList" class="section">
      <h2>Ù„ÛŒØ³Øª Ù…ÙˆØ§Ø¯ ØºØ°Ø§ÛŒÛŒ</h2>
      <table class="food-table">
        <thead>
          <tr>
            <th>Ù†Ø§Ù…</th>
            <th>Ø³Ø¯ÛŒÙ… (mg)</th>
            <th>Ù¾ØªØ§Ø³ÛŒÙ… (mg)</th>
            <th>ÙØ³ÙØ± (mg)</th>
            <th>Ù¾Ø±ÙˆØªØ¦ÛŒÙ† (g)</th>
            <th>Ø¢Ø¨ (ml)</th>
            <th>Ø§Ù‚Ø¯Ø§Ù…Ø§Øª</th>
          </tr>
        </thead>
        <tbody id="foodDatabase"></tbody>
      </table>
      <form class="edit-food-form" id="editFoodForm" onsubmit="editFood(event)">
        <input type="text" id="editFoodName" placeholder="Ù†Ø§Ù… Ù…Ø§Ø¯Ù‡ ØºØ°Ø§ÛŒÛŒ" required>
        <input type="number" id="editSodium" placeholder="Ø³Ø¯ÛŒÙ… (Ù…ÛŒÙ„ÛŒâ€ŒÚ¯Ø±Ù…)" required>
        <input type="number" id="editPotassium" placeholder="Ù¾ØªØ§Ø³ÛŒÙ… (Ù…ÛŒÙ„ÛŒâ€ŒÚ¯Ø±Ù…)" required>
        <input type="number" id="editPhosphorus" placeholder="ÙØ³ÙØ± (Ù…ÛŒÙ„ÛŒâ€ŒÚ¯Ø±Ù…)" required>
        <input type="number" id="editProtein" placeholder="Ù¾Ø±ÙˆØªØ¦ÛŒÙ† (Ú¯Ø±Ù…)" required>
        <input type="number" id="editWater" placeholder="Ø¢Ø¨ (Ù…ÛŒÙ„ÛŒâ€ŒÙ„ÛŒØªØ±)" required>
        <button type="submit">Ø°Ø®ÛŒØ±Ù‡ ØªØºÛŒÛŒØ±Ø§Øª</button>
        <button type="button" onclick="cancelEdit()">Ø§Ù†ØµØ±Ø§Ù</button>
      </form>
    </div>

    <!-- Ø§ÙØ²ÙˆØ¯Ù† ØºØ°Ø§ -->
    <div id="addFood" class="section">
      <h2>Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ù…Ø§Ø¯Ù‡ ØºØ°Ø§ÛŒÛŒ Ø¬Ø¯ÛŒØ¯</h2>
      <form class="new-food-form" onsubmit="addNewFood(event)">
        <input type="text" id="newFoodName" placeholder="Ù†Ø§Ù… Ù…Ø§Ø¯Ù‡ ØºØ°Ø§ÛŒÛŒ" required>
        <input type="number" id="sodium" placeholder="Ø³Ø¯ÛŒÙ… (Ù…ÛŒÙ„ÛŒâ€ŒÚ¯Ø±Ù…)" required>
        <input type="number" id="potassium" placeholder="Ù¾ØªØ§Ø³ÛŒÙ… (Ù…ÛŒÙ„ÛŒâ€ŒÚ¯Ø±Ù…)" required>
        <input type="number" id="phosphorus" placeholder="ÙØ³ÙØ± (Ù…ÛŒÙ„ÛŒâ€ŒÚ¯Ø±Ù…)" required>
        <input type="number" id="protein" placeholder="Ù¾Ø±ÙˆØªØ¦ÛŒÙ† (Ú¯Ø±Ù…)" required>
        <input type="number" id="water" placeholder="Ø¢Ø¨ (Ù…ÛŒÙ„ÛŒâ€ŒÙ„ÛŒØªØ±)" required>
        <button type="submit">Ø°Ø®ÛŒØ±Ù‡</button>
      </form>
    </div>

    <!-- ØªØ§Ø±ÛŒØ®Ú†Ù‡ -->
    <div id="history" class="section">
      <h2>ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ù…ØµØ±Ù</h2>
      <button class="reset-button" onclick="clearHistory()">Ø­Ø°Ù ØªØ§Ø±ÛŒØ®Ú†Ù‡</button>
      <table class="history-table">
        <thead>
          <tr>
            <th>Ù†Ø§Ù… ØºØ°Ø§</th>
            <th>Ù…Ù‚Ø¯Ø§Ø± (ÙˆØ§Ø­Ø¯)</th>
            <th>ÙˆØ¹Ø¯Ù‡</th>
            <th>Ø±ÙˆØ² Ù‡ÙØªÙ‡</th>
          </tr>
        </thead>
        <tbody id="historyTable"></tbody>
      </table>
    </div>

    <!-- ØªÙ†Ø¸ÛŒÙ…Ø§Øª -->
    <div id="settings" class="section">
      <h2>ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù…Ø­Ø¯ÙˆØ¯ÛŒØªâ€ŒÙ‡Ø§</h2>
      <form class="settings-form" onsubmit="saveSettings(event)">
        <label for="sodiumLimit">Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Ø³Ø¯ÛŒÙ… (Ù…ÛŒÙ„ÛŒâ€ŒÚ¯Ø±Ù…):</label>
        <input type="number" id="sodiumLimit" required>
        <label for="potassiumLimit">Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Ù¾ØªØ§Ø³ÛŒÙ… (Ù…ÛŒÙ„ÛŒâ€ŒÚ¯Ø±Ù…):</label>
        <input type="number" id="potassiumLimit" required>
        <label for="phosphorusLimit">Ù…Ø­Ø¯ÙˆØ¯ÛŒØª ÙØ³ÙØ± (Ù…ÛŒÙ„ÛŒâ€ŒÚ¯Ø±Ù…):</label>
        <input type="number" id="phosphorusLimit" required>
        <label for="proteinMinLimit">Ø­Ø¯Ø§Ù‚Ù„ Ù¾Ø±ÙˆØªØ¦ÛŒÙ† (Ú¯Ø±Ù…):</label>
        <input type="number" id="proteinMinLimit" required>
        <label for="proteinMaxLimit">Ø­Ø¯Ø§Ú©Ø«Ø± Ù¾Ø±ÙˆØªØ¦ÛŒÙ† (Ú¯Ø±Ù…):</label>
        <input type="number" id="proteinMaxLimit" required>
        <label for="waterLimit">Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Ø¢Ø¨ (Ù…ÛŒÙ„ÛŒâ€ŒÙ„ÛŒØªØ±):</label>
        <input type="number" id="waterLimit" required>
        <button type="submit">Ø°Ø®ÛŒØ±Ù‡ Ù…Ø­Ø¯ÙˆØ¯ÛŒØªâ€ŒÙ‡Ø§</button>
      </form>
      <button class="reset-button" onclick="resetData()">Ø¨Ø§Ø²Ù†Ø´Ø§Ù†ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§</button>
      <div class="theme-settings">
        <h2>ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù¾ÙˆØ³ØªÙ‡</h2>
        <label for="fontSize">Ø§Ù†Ø¯Ø§Ø²Ù‡ ÙÙˆÙ†Øª:</label>
        <input type="number" id="fontSize" value="1" step="0.1">
        <button onclick="applyTheme()">Ø§Ø¹Ù…Ø§Ù„ Ù¾ÙˆØ³ØªÙ‡</button>
      </div>
    </div>
  </div>

  <!-- Ø«Ø¨Øª Ø³Ø±ÙˆÛŒØ³â€ŒÙˆØ±Ú©Ø± Ø¬Ù‡Øª PWA -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function() {
        navigator.serviceWorker.register('/sw.js')
          .then(function(registration) {
            console.log('ServiceWorker registration successful with scope: ', registration.scope);
          })
          .catch(function(err) {
            console.error('ServiceWorker registration failed: ', err);
          });
      });
    }
  </script>

  <script>
    // Generate unique UUID
    function generateUUID() {
      return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
        var r = Math.random() * 16 | 0,
            v = c === 'x' ? r : (r & 0x3 | 0x8);
        return v.toString(16);
      });
    }
    
    // Retrieve or create userId
    let userId = localStorage.getItem('userId');
    if (!userId) {
      userId = generateUUID();
      localStorage.setItem('userId', userId);
    }
    
    // Save and get user data
    function saveData(data) {
      localStorage.setItem(`userData_${userId}`, JSON.stringify(data));
    }
    
    function getData() {
      const data = localStorage.getItem(`userData_${userId}`);
      return data ? JSON.parse(data) : null;
    }
    
    // Load initial data
    let userData = getData();
    let foodDB = (userData && userData.foodDB) || [
      { name: 'Ù…Ø±Øº', sodium: 70, potassium: 280, phosphorus: 200, protein: 25, water: 65 },
      { name: 'Ø¨Ø±Ù†Ø¬', sodium: 5, potassium: 35, phosphorus: 40, protein: 8, water: 70 },
      { name: 'Ø³ÛŒØ¨ Ø²Ù…ÛŒÙ†ÛŒ', sodium: 10, potassium: 400, phosphorus: 50, protein: 2, water: 80 },
      { name: 'Ø´ÛŒØ±', sodium: 50, potassium: 350, phosphorus: 250, protein: 3.4, water: 90 },
      { name: 'Ù†Ø§Ù†', sodium: 200, potassium: 80, phosphorus: 70, protein: 9, water: 40 },
      { name: 'ØªØ®Ù… Ù…Ø±Øº', sodium: 60, potassium: 70, phosphorus: 90, protein: 13, water: 75 },
      { name: 'Ù…Ø§Ø³Øª', sodium: 80, potassium: 150, phosphorus: 120, protein: 11, water: 85 },
      { name: 'Ø®ÛŒØ§Ø±', sodium: 5, potassium: 150, phosphorus: 20, protein: 0.7, water: 95 },
      { name: 'Ú¯ÙˆØ¬Ù‡ ÙØ±Ù†Ú¯ÛŒ', sodium: 10, potassium: 250, phosphorus: 30, protein: 0.9, water: 90 },
      { name: 'Ù‡ÙˆÛŒØ¬', sodium: 15, potassium: 300, phosphorus: 35, protein: 0.9, water: 88 }
    ];
    let dailyIntake = (userData && userData.dailyIntake) || [];
    let settings = (userData && userData.settings) || {
      sodiumLimit: 2000,
      potassiumLimit: 2000,
      phosphorusLimit: 1000,
      waterLimit: 1500,
      proteinMinLimit: 40,
      proteinMaxLimit: 60
    };
    let themeSettings = (userData && userData.themeSettings) || { fontSize: '1' };
    let currentEditIndex = null;
    
    // Article contents for educational articles
    const articleContents = [
      "Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ù‚Ø§Ù„Ù‡ Û±: Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Ù…Ø§ÛŒØ¹Ø§Øª Ø¨Ø±Ø§ÛŒ Ø¨ÛŒÙ…Ø§Ø±Ø§Ù† Ø¯ÛŒØ§Ù„ÛŒØ²ÛŒ Ø¨Ø³ÛŒØ§Ø± Ù…Ù‡Ù… Ø§Ø³Øª. Ø¬Ø²Ø¦ÛŒØ§Øª Ùˆ ØªÙˆØ¶ÛŒØ­Ø§Øª ØªÚ©Ù…ÛŒÙ„ÛŒ Ø¯Ø± Ø§ÛŒÙ† Ø¨Ø®Ø´ Ø¢Ù…Ø¯Ù‡ Ø§Ø³Øª.",
      "Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ù‚Ø§Ù„Ù‡ Û²: Ù…Ø¯ÛŒØ±ÛŒØª Ù…ØµØ±Ù Ù¾ØªØ§Ø³ÛŒÙ… Ø±ÙˆØ²Ø§Ù†Ù‡ Ø§Ø² Ù†Ø¸Ø± Ø³Ù„Ø§Ù…ØªÛŒ Ø§Ù‡Ù…ÛŒØª ÙˆÛŒÚ˜Ù‡â€ŒØ§ÛŒ Ø¯Ø§Ø±Ø¯.",
      "Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ù‚Ø§Ù„Ù‡ Û³: Ø¨Ø±Ø±Ø³ÛŒ Ù…Ù†Ø§Ø¨Ø¹ ØºØ°Ø§ÛŒÛŒ Ø­Ø§ÙˆÛŒ ÙØ³ÙØ± Ø¨Ø§Ù„Ø§ Ùˆ Ù†Ú©Ø§Øª Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ø¢Ù†.",
      "Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ù‚Ø§Ù„Ù‡ Û´: Ø±Ø§Ù‡Ú©Ø§Ø±Ù‡Ø§ÛŒ Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø±ÛŒØ²ÛŒ ÙˆØ¹Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ØºØ°Ø§ÛŒÛŒ Ù‡ÙØªÚ¯ÛŒ Ø¨Ù‡ ØªÙØµÛŒÙ„ ØªÙˆØ¶ÛŒØ­ Ø¯Ø§Ø¯Ù‡ Ø´Ø¯Ù‡ Ø§Ø³Øª.",
      "Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ù‚Ø§Ù„Ù‡ Ûµ: Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ†â€ŒÙ‡Ø§ÛŒ Ù…Ù†Ø§Ø³Ø¨ Ù†Ù…Ú© Ø¯Ø± Ø±Ú˜ÛŒÙ… ØºØ°Ø§ÛŒÛŒ Ø¯ÛŒØ§Ù„ÛŒØ²ÛŒ Ø¯Ø± Ø§ÛŒÙ† Ù…Ù‚Ø§Ù„Ù‡ Ø¨Ø±Ø±Ø³ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯.",
      "Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ù‚Ø§Ù„Ù‡ Û¶: Ú©Ù†ØªØ±Ù„ ÙØ´Ø§Ø± Ø®ÙˆÙ† Ø¯Ø± Ø¨ÛŒÙ…Ø§Ø±Ø§Ù† Ø¯ÛŒØ§Ù„ÛŒØ²ÛŒ Ø§Ø² Ù†Ú©Ø§Øª Ú©Ù„ÛŒØ¯ÛŒ Ø§Ø³Øª.",
      "Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ù‚Ø§Ù„Ù‡ Û·: Ù†Ù‚Ø´ Ù¾Ø±ÙˆØªØ¦ÛŒÙ† Ø¯Ø± ØªØºØ°ÛŒÙ‡ Ø¨ÛŒÙ…Ø§Ø±Ø§Ù† Ø¯ÛŒØ§Ù„ÛŒØ²ÛŒ Ø¨Ø§ Ø¬Ø²Ø¦ÛŒØ§Øª ØªÙˆØ¶ÛŒØ­ Ø¯Ø§Ø¯Ù‡ Ø´Ø¯Ù‡ Ø§Ø³Øª.",
      "Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ù‚Ø§Ù„Ù‡ Û¸: Ù†Ú©Ø§Øª Ù…Ø¯ÛŒØ±ÛŒØª ÙˆØ²Ù† Ø¨ÛŒÙ† Ø¬Ù„Ø³Ø§Øª Ø¯ÛŒØ§Ù„ÛŒØ² Ø¨Ù‡ ØªÙØµÛŒÙ„ Ø§Ø±Ø§Ø¦Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.",
      "Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ù‚Ø§Ù„Ù‡ Û¹: Ù…ÙˆØ§Ø±Ø¯ ØºØ°Ø§ÛŒÛŒ Ù…Ù…Ù†ÙˆØ¹Ù‡ Ø¨Ø±Ø§ÛŒ Ø¨ÛŒÙ…Ø§Ø±Ø§Ù† Ú©Ù„ÛŒÙˆÛŒ Ø´Ø±Ø­ Ø¯Ø§Ø¯Ù‡ Ø´Ø¯Ù‡ Ø§Ø³Øª.",
      "Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ù‚Ø§Ù„Ù‡ Û±Û°: Ø±Ø§Ù‡Ú©Ø§Ø±Ù‡Ø§ÛŒ Ú©Ø§Ù‡Ø´ ØªØ´Ù†Ú¯ÛŒ Ùˆ Ù…ØµØ±Ù Ù…Ø§ÛŒØ¹Ø§Øª Ø¨Ù‡ÛŒÙ†Ù‡ Ø¯Ø± Ø§ÛŒÙ† Ù…Ù‚Ø§Ù„Ù‡ Ø¢Ù…Ø¯Ù‡ Ø§Ø³Øª.",
      "Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ù‚Ø§Ù„Ù‡ Û±Û±: Ù…ØµØ±Ù ØµØ­ÛŒØ­ Ù…Ú©Ù…Ù„â€ŒÙ‡Ø§ÛŒ ØºØ°Ø§ÛŒÛŒ Ùˆ Ù†Ú©Ø§Øª Ù…Ø±Ø¨ÙˆØ·Ù‡.",
      "Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ù‚Ø§Ù„Ù‡ Û±Û²: Ø§Ù‡Ù…ÛŒØª ÙˆØ±Ø²Ø´ Ùˆ ÙØ¹Ø§Ù„ÛŒØª Ø¨Ø¯Ù†ÛŒ Ù…Ù†Ø§Ø³Ø¨ Ø¨Ø±Ø§ÛŒ Ø¨ÛŒÙ…Ø§Ø±Ø§Ù† Ø¯ÛŒØ§Ù„ÛŒØ²ÛŒ.",
      "Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ù‚Ø§Ù„Ù‡ Û±Û³: Ø±Ø§Ù‡Ú©Ø§Ø±Ù‡Ø§ÛŒ Ú©Ù†ØªØ±Ù„ Ù‚Ù†Ø¯ Ø®ÙˆÙ† Ø¯Ø± Ø¨ÛŒÙ…Ø§Ø±Ø§Ù† Ø¯ÛŒØ§Ø¨ØªÛŒ Ø¯ÛŒØ§Ù„ÛŒØ²ÛŒ.",
      "Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ù‚Ø§Ù„Ù‡ Û±Û´: Ù…Ø¹Ø±ÙÛŒ Ø±ÙˆØ´â€ŒÙ‡Ø§ÛŒ Ù¾Ø®Øª Ùˆ ØªÙ‡ÛŒÙ‡ ØºØ°Ø§ÛŒ Ù…Ù†Ø§Ø³Ø¨ Ø¨Ø±Ø§ÛŒ Ø¨ÛŒÙ…Ø§Ø±.",
      "Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ù‚Ø§Ù„Ù‡ Û±Ûµ: Ø§ØµÙˆÙ„ Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ø³ØªØ±Ø³ Ùˆ Ø­ÙØ¸ Ø³Ù„Ø§Ù…Øª Ø±ÙˆØ§Ù† Ø¯Ø± Ø±ÙˆÙ†Ø¯ Ø¯ÛŒØ§Ù„ÛŒØ².",
      "Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ù‚Ø§Ù„Ù‡ Û±Û¶: Ø¢Ø´Ù†Ø§ÛŒÛŒ Ø¨Ø§ Ù†Ø´Ø§Ù†Ù‡â€ŒÙ‡Ø§ÛŒ Ø§ÙˆØ±Ú˜Ø§Ù†Ø³ÛŒ Ø¯Ø± Ø¨ÛŒÙ…Ø§Ø±Ø§Ù† Ø¯ÛŒØ§Ù„ÛŒØ²ÛŒ.",
      "Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ù‚Ø§Ù„Ù‡ Û±Û·: Ù…Ø±Ø§Ù‚Ø¨Øª Ø§Ø² Ø¯Ø³ØªØ±Ø³ÛŒ Ø¹Ø±ÙˆÙ‚ÛŒ Ùˆ Ù†Ú©Ø§Øª ØªØ®ØµØµÛŒ Ø¢Ù†.",
      "Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ù‚Ø§Ù„Ù‡ Û±Û¸: Ø¨Ø±Ø±Ø³ÛŒ ØªØ¯Ø§Ø®Ù„Ø§Øª Ø¯Ø§Ø±ÙˆÛŒÛŒ Ø¨Ø§ Ù…ÙˆØ§Ø¯ ØºØ°Ø§ÛŒÛŒ Ø¯Ø± Ø¨ÛŒÙ…Ø§Ø±Ø§Ù†.",
      "Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ù‚Ø§Ù„Ù‡ Û±Û¹: Ø§Ø±Ø§Ø¦Ù‡ Ù†Ù…ÙˆÙ†Ù‡ Ø¨Ø±Ù†Ø§Ù…Ù‡ ØºØ°Ø§ÛŒÛŒ Ø±ÙˆØ²Ø§Ù†Ù‡ Ø¨Ø±Ø§ÛŒ Ø¨ÛŒÙ…Ø§Ø±Ø§Ù†.",
      "Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ù‚Ø§Ù„Ù‡ Û²Û°: Ù†Ú©Ø§Øª Ù…Ù‡Ù… Ùˆ ØªÙˆØµÛŒÙ‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø±Ø§ÛŒ Ù‡Ù…Ø±Ø§Ù‡Ø§Ù† Ø¨ÛŒÙ…Ø§Ø±."
    ];
    
    // Educational video links
    const videoLinks = [
      'https://www.aparat.com/v/your_video_id_1',
      'https://www.aparat.com/v/your_video_id_2'
    ];
    
    // Setup charts using Chart.js and attach to window object
    window.sodiumChart = new Chart(document.getElementById('sodiumChart'), {
      type: 'doughnut',
      data: {
        labels: ['Ù…ØµØ±Ù Ø´Ø¯Ù‡', 'Ø¨Ø§Ù‚ÛŒ Ù…Ø§Ù†Ø¯Ù‡'],
        datasets: [{
          data: [0, 100],
          backgroundColor: ['rgba(255, 99, 132, 0.7)', 'rgba(220,220,220,0.7)'],
          borderColor: ['rgba(255, 99, 132, 1)', 'rgba(220,220,220,1)'],
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        cutout: '70%',
        plugins: { legend: { display: false } }
      }
    });
    
    window.potassiumChart = new Chart(document.getElementById('potassiumChart'), {
      type: 'doughnut',
      data: {
        labels: ['Ù…ØµØ±Ù Ø´Ø¯Ù‡', 'Ø¨Ø§Ù‚ÛŒ Ù…Ø§Ù†Ø¯Ù‡'],
        datasets: [{
          data: [0, 100],
          backgroundColor: ['rgba(54, 162, 235, 0.7)', 'rgba(220,220,220,0.7)'],
          borderColor: ['rgba(54, 162, 235, 1)', 'rgba(220,220,220,1)'],
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        cutout: '70%',
        plugins: { legend: { display: false } }
      }
    });
    
    window.phosphorusChart = new Chart(document.getElementById('phosphorusChart'), {
      type: 'doughnut',
      data: {
        labels: ['Ù…ØµØ±Ù Ø´Ø¯Ù‡', 'Ø¨Ø§Ù‚ÛŒ Ù…Ø§Ù†Ø¯Ù‡'],
        datasets: [{
          data: [0, 100],
          backgroundColor: ['rgba(255, 206, 86, 0.7)', 'rgba(220,220,220,0.7)'],
          borderColor: ['rgba(255, 206, 86, 1)', 'rgba(220,220,220,1)'],
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        cutout: '70%',
        plugins: { legend: { display: false } }
      }
    });
    
    window.waterChart = new Chart(document.getElementById('waterChart'), {
      type: 'doughnut',
      data: {
        labels: ['Ù…ØµØ±Ù Ø´Ø¯Ù‡', 'Ø¨Ø§Ù‚ÛŒ Ù…Ø§Ù†Ø¯Ù‡'],
        datasets: [{
          data: [0, 100],
          backgroundColor: ['rgba(75, 192, 192, 0.7)', 'rgba(220,220,220,0.7)'],
          borderColor: ['rgba(75, 192, 192, 1)', 'rgba(220,220,220,1)'],
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        cutout: '70%',
        plugins: { legend: { display: false } }
      }
    });
    
    window.proteinChart = new Chart(document.getElementById('proteinChart'), {
      type: 'doughnut',
      data: {
        labels: ['Ù…ØµØ±Ù Ø´Ø¯Ù‡', 'Ø¨Ø§Ù‚ÛŒ Ù…Ø§Ù†Ø¯Ù‡'],
        datasets: [{
          data: [0, 100],
          backgroundColor: ['rgba(153, 102, 255, 0.7)', 'rgba(220,220,220,0.7)'],
          borderColor: ['rgba(153, 102, 255, 1)', 'rgba(220,220,220,1)'],
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        cutout: '70%',
        plugins: { legend: { display: false } }
      }
    });
    
    // --------------- Core Functions ---------------
    
    function showSection(sectionId) {
      document.querySelectorAll('.section').forEach(section => section.classList.remove('active'));
      document.getElementById(sectionId).classList.add('active');
      document.querySelectorAll('.nav button').forEach(button => button.classList.remove('active'));
      document.querySelector(`.nav button[onclick="showSection('${sectionId}')"]`).classList.add('active');
    }
    
    function updateChart() {
      let currentTotals = calculateCurrentTotals();
      ['sodium', 'potassium', 'phosphorus', 'water', 'protein'].forEach(nutrient => {
        let limit = settings[`${nutrient}Limit`];
        if (nutrient === 'protein') {
          limit = settings.proteinMinLimit;
        }
        let percentage = limit ? Math.min((currentTotals[nutrient] / limit) * 100, 100) : 0;
        window[`${nutrient}Chart`].data.datasets[0].data = [percentage, 100 - percentage];
        window[`${nutrient}Chart`].update();
    
        document.getElementById(`${nutrient}Percentage`).textContent = `${percentage.toFixed(0)}%`;
        let unit = (nutrient === 'water') ? 'Ù…ÛŒÙ„ÛŒâ€ŒÙ„ÛŒØªØ±' : (nutrient === 'protein' ? 'Ú¯Ø±Ù…' : 'Ù…ÛŒÙ„ÛŒâ€ŒÚ¯Ø±Ù…');
        document.getElementById(`${nutrient}Value`).textContent = `${currentTotals[nutrient].toFixed(1)} ${unit}`;
      });
      updateFaceStickers(currentTotals);
    }
    
    function updateFaceStickers(currentTotals) {
      ['sodium', 'potassium', 'phosphorus', 'water'].forEach(nutrient => {
        let percentage = settings[`${nutrient}Limit`] ? (currentTotals[nutrient] / settings[`${nutrient}Limit`]) * 100 : 0;
        let faceSticker = document.getElementById(`${nutrient}FaceSticker`);
        faceSticker.textContent = getFaceSticker(percentage);
      });
      let proteinStatus = getProteinStatus(currentTotals.protein);
      document.getElementById('proteinFaceSticker').textContent = proteinStatus.sticker;
    }
    
    function getFaceSticker(percentage) {
      if (percentage < 50) return 'ğŸ˜Š';
      if (percentage < 80) return 'ğŸ˜';
      return 'ğŸ˜Ÿ';
    }
    
    function getProteinStatus(proteinIntake) {
      if (proteinIntake < settings.proteinMinLimit) return { status: 'low', sticker: 'ğŸ˜Ÿ' };
      if (proteinIntake > settings.proteinMaxLimit) return { status: 'high', sticker: 'âš ï¸' };
      return { status: 'good', sticker: 'âœ…' };
    }
    
    function calculateCurrentTotals() {
      let totals = { sodium: 0, potassium: 0, phosphorus: 0, water: 0, protein: 0 };
      dailyIntake.forEach(entry => {
        let food = foodDB.find(f => f.name === entry.foodName);
        if (food) {
          totals.sodium += food.sodium * entry.amount;
          totals.potassium += food.potassium * entry.amount;
          totals.phosphorus += food.phosphorus * entry.amount;
          totals.water += food.water * entry.amount;
          totals.protein += food.protein * entry.amount;
        }
      });
      return totals;
    }
    
    function addFoodEntry(event) {
      event.preventDefault();
      const foodName = document.getElementById('foodSelect').value;
      const amount = parseInt(document.getElementById('amount').value);
      const mealType = document.getElementById('mealType').value;
      const dayOfWeek = document.getElementById('dayOfWeek').value;
      dailyIntake.push({ foodName, amount, mealType, dayOfWeek });
      updateDashboard();
      displayHistory();
      saveData({ foodDB, dailyIntake, settings, themeSettings });
    }
    
    function populateFoodSelect() {
      const select = document.getElementById('foodSelect');
      select.innerHTML = '';
      foodDB.forEach(food => {
        const option = document.createElement('option');
        option.value = food.name;
        option.textContent = food.name;
        select.appendChild(option);
      });
    }
    
    function displayFoodDatabase() {
      const table = document.getElementById('foodDatabase');
      table.innerHTML = '';
      foodDB.forEach((food, index) => {
        const row = table.insertRow();
        row.insertCell(0).textContent = food.name;
        row.insertCell(1).textContent = food.sodium;
        row.insertCell(2).textContent = food.potassium;
        row.insertCell(3).textContent = food.phosphorus;
        row.insertCell(4).textContent = food.protein;
        row.insertCell(5).textContent = food.water;
        
        let editButton = document.createElement('button');
        editButton.textContent = 'ÙˆÛŒØ±Ø§ÛŒØ´';
        editButton.onclick = () => showEditForm(index);
        let deleteButton = document.createElement('button');
        deleteButton.textContent = 'Ø­Ø°Ù';
        deleteButton.onclick = () => deleteFood(index);
        
        let actionsCell = row.insertCell(6);
        actionsCell.appendChild(editButton);
        actionsCell.appendChild(deleteButton);
      });
    }
    
    function showEditForm(index) {
      currentEditIndex = index;
      const food = foodDB[index];
      document.getElementById('editFoodName').value = food.name;
      document.getElementById('editSodium').value = food.sodium;
      document.getElementById('editPotassium').value = food.potassium;
      document.getElementById('editPhosphorus').value = food.phosphorus;
      document.getElementById('editProtein').value = food.protein;
      document.getElementById('editWater').value = food.water;
      document.getElementById('editFoodForm').classList.add('active');
    }
    
    function editFood(event) {
      event.preventDefault();
      if (currentEditIndex === null) return;
      const updatedFood = {
        name: document.getElementById('editFoodName').value,
        sodium: parseInt(document.getElementById('editSodium').value),
        potassium: parseInt(document.getElementById('editPotassium').value),
        phosphorus: parseInt(document.getElementById('editPhosphorus').value),
        protein: parseInt(document.getElementById('editProtein').value),
        water: parseInt(document.getElementById('editWater').value)
      };
      foodDB[currentEditIndex] = updatedFood;
      currentEditIndex = null;
      document.getElementById('editFoodForm').classList.remove('active');
      displayFoodDatabase();
      populateFoodSelect();
      saveData({ foodDB, dailyIntake, settings, themeSettings });
    }
    
    function cancelEdit() {
      currentEditIndex = null;
      document.getElementById('editFoodForm').classList.remove('active');
    }
    
    function deleteFood(index) {
      foodDB.splice(index, 1);
      displayFoodDatabase();
      populateFoodSelect();
      saveData({ foodDB, dailyIntake, settings, themeSettings });
    }
    
    function addNewFood(event) {
  event.preventDefault();
  const newFood = {
    name: document.getElementById('newFoodName').value,
    sodium: parseInt(document.getElementById('sodium').value),
    potassium: parseInt(document.getElementById('potassium').value),
    phosphorus: parseInt(document.getElementById('phosphorus').value),
    protein: parseInt(document.getElementById('protein').value),
    water: parseInt(document.getElementById('water').value)
  };
  foodDB.push(newFood);
  displayFoodDatabase();
  populateFoodSelect();
  saveData({ foodDB, dailyIntake, settings, themeSettings });
  
  // Reset input fields
  document.getElementById('newFoodName').value = '';
  document.getElementById('sodium').value = '';
  document.getElementById('potassium').value = '';
  document.getElementById('phosphorus').value = '';
  document.getElementById('protein').value = '';
  document.getElementById('water').value = '';
}

function displayHistory() {
  const table = document.getElementById('historyTable');
  table.innerHTML = '';
  dailyIntake.forEach(entry => {
    const row = table.insertRow();
    row.insertCell(0).textContent = entry.foodName;
    row.insertCell(1).textContent = entry.amount;
    row.insertCell(2).textContent = entry.mealType;
    row.insertCell(3).textContent = entry.dayOfWeek;
  });
}

function clearHistory() {
  dailyIntake = [];
  updateDashboard();
  displayHistory();
  saveData({ foodDB, dailyIntake, settings, themeSettings });
}

function saveSettings(event) {
  event.preventDefault();
  settings.sodiumLimit = parseInt(document.getElementById('sodiumLimit').value);
  settings.potassiumLimit = parseInt(document.getElementById('potassiumLimit').value);
  settings.phosphorusLimit = parseInt(document.getElementById('phosphorusLimit').value);
  settings.waterLimit = parseInt(document.getElementById('waterLimit').value);
  settings.proteinMinLimit = parseInt(document.getElementById('proteinMinLimit').value);
  settings.proteinMaxLimit = parseInt(document.getElementById('proteinMaxLimit').value);
  updateDashboard();
  saveData({ foodDB, dailyIntake, settings, themeSettings });
}

function resetData() {
  localStorage.removeItem(`userData_${userId}`);
  foodDB = [
    { name: 'Ù…Ø±Øº', sodium: 70, potassium: 280, phosphorus: 200, protein: 25, water: 65 },
    { name: 'Ø¨Ø±Ù†Ø¬', sodium: 5, potassium: 35, phosphorus: 40, protein: 8, water: 70 },
    { name: 'Ø³ÛŒØ¨ Ø²Ù…ÛŒÙ†ÛŒ', sodium: 10, potassium: 400, phosphorus: 50, protein: 2, water: 80 },
    { name: 'Ø´ÛŒØ±', sodium: 50, potassium: 350, phosphorus: 250, protein: 3.4, water: 90 },
    { name: 'Ù†Ø§Ù†', sodium: 200, potassium: 80, phosphorus: 70, protein: 9, water: 40 },
    { name: 'ØªØ®Ù… Ù…Ø±Øº', sodium: 60, potassium: 70, phosphorus: 90, protein: 13, water: 75 },
    { name: 'Ù…Ø§Ø³Øª', sodium: 80, potassium: 150, phosphorus: 120, protein: 11, water: 85 },
    { name: 'Ø®ÛŒØ§Ø±', sodium: 5, potassium: 150, phosphorus: 20, protein: 0.7, water: 95 },
    { name: 'Ú¯ÙˆØ¬Ù‡ ÙØ±Ù†Ú¯ÛŒ', sodium: 10, potassium: 250, phosphorus: 30, protein: 0.9, water: 90 },
    { name: 'Ù‡ÙˆÛŒØ¬', sodium: 15, potassium: 300, phosphorus: 35, protein: 0.9, water: 88 }
  ];
  dailyIntake = [];
  settings = {
    sodiumLimit: 2000,
    potassiumLimit: 2000,
    phosphorusLimit: 1000,
    waterLimit: 1500,
    proteinMinLimit: 40,
    proteinMaxLimit: 60
  };
  themeSettings = { fontSize: '1' };
  updateDashboard();
  displayFoodDatabase();
  populateFoodSelect();
  displayHistory();
  applyTheme();
}

function applyTheme() {
  themeSettings.fontSize = document.getElementById('fontSize').value + 'rem';
  document.body.style.fontSize = themeSettings.fontSize;
  saveData({ foodDB, dailyIntake, settings, themeSettings });
}

function updateDashboard() {
  updateChart();
  displayWarnings();
  let currentTotals = calculateCurrentTotals();
  document.getElementById('currentTotals').innerHTML = `
    <p>Ø³Ø¯ÛŒÙ…: ${currentTotals.sodium.toFixed(1)} / ${settings.sodiumLimit} mg</p>
    <p>Ù¾ØªØ§Ø³ÛŒÙ…: ${currentTotals.potassium.toFixed(1)} / ${settings.potassiumLimit} mg</p>
    <p>ÙØ³ÙØ±: ${currentTotals.phosphorus.toFixed(1)} / ${settings.phosphorusLimit} mg</p>
    <p>Ø¢Ø¨: ${currentTotals.water.toFixed(1)} / ${settings.waterLimit} ml</p>
    <p>Ù¾Ø±ÙˆØªØ¦ÛŒÙ†: ${currentTotals.protein.toFixed(1)} g (Ø­Ø¯Ø§Ù‚Ù„: ${settings.proteinMinLimit} g)</p>
  `;
}

function displayWarnings() {
  let warningsDiv = document.getElementById('warnings');
  warningsDiv.innerHTML = '';
  let currentTotals = calculateCurrentTotals();
  
  ['sodium', 'potassium', 'phosphorus', 'water'].forEach(nutrient => {
    if (currentTotals[nutrient] > settings[`${nutrient}Limit`]) {
      addWarning(warningsDiv, `Ù…ØµØ±Ù ${nutrient} (${currentTotals[nutrient].toFixed(1)} ${nutrient === 'water' ? 'Ù…ÛŒÙ„ÛŒâ€ŒÙ„ÛŒØªØ±' : 'Ù…ÛŒÙ„ÛŒâ€ŒÚ¯Ø±Ù…'}) Ø¨ÛŒØ´ Ø§Ø² Ø­Ø¯ Ù…Ø¬Ø§Ø² (${settings[`${nutrient}Limit`]} ${nutrient === 'water' ? 'Ù…ÛŒÙ„ÛŒâ€ŒÙ„ÛŒØªØ±' : 'Ù…ÛŒÙ„ÛŒâ€ŒÚ¯Ø±Ù…'}) Ø§Ø³Øª.`);
    }
  });
  
  let proteinStatus = getProteinStatus(currentTotals.protein);
  if (proteinStatus.status !== 'good') {
    let message = proteinStatus.status === 'low'
      ? `Ù…ØµØ±Ù Ù¾Ø±ÙˆØªØ¦ÛŒÙ† (${currentTotals.protein.toFixed(1)} Ú¯Ø±Ù…) Ú©Ù…ØªØ± Ø§Ø² Ø­Ø¯Ø§Ù‚Ù„ (${settings.proteinMinLimit} Ú¯Ø±Ù…) Ø§Ø³Øª.`
      : `Ù…ØµØ±Ù Ù¾Ø±ÙˆØªØ¦ÛŒÙ† (${currentTotals.protein.toFixed(1)} Ú¯Ø±Ù…) Ø¨ÛŒØ´ØªØ± Ø§Ø² Ø­Ø¯Ø§Ú©Ø«Ø± (${settings.proteinMaxLimit} Ú¯Ø±Ù…) Ø§Ø³Øª.`;
    addWarning(warningsDiv, message);
  }
}

function addWarning(container, message) {
  let warning = document.createElement('div');
  warning.classList.add('warning');
  warning.textContent = message;
  container.appendChild(warning);
}

function loadVideos() {
  const videoContainer = document.getElementById('videoContainer');
  videoLinks.forEach(link => {
    const iframe = document.createElement('iframe');
    iframe.src = link;
    iframe.allowFullscreen = true;
    videoContainer.appendChild(iframe);
  });
}

function showArticleContent(index) {
  document.getElementById('articleContent').innerHTML = `<p>${articleContents[index]}</p>`;
}

document.addEventListener('DOMContentLoaded', () => {
  if (dailyIntake.length === 0) {
    dailyIntake.push({ foodName: foodDB[0].name, amount: 1, mealType: 'breakfast', dayOfWeek: 'saturday' });
  }
  applyTheme();
  populateFoodSelect();
  displayFoodDatabase();
  displayHistory();
  updateDashboard();
  loadVideos();
  showSection('dashboard');
  console.log('Page fully loaded, dashboard updated.');
});
      </script></body></html>